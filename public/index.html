<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deepgram Audio Analysis</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            background: linear-gradient(90deg, #00c9ff, #92fe9d);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }
        
        .subtitle {
            color: #ddd;
            font-size: 1.2rem;
            margin-top: 15px;
        }
        
        .card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .card-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: #00c9ff;
            display: flex;
            align-items: center;
        }
        
        .card-title i {
            margin-right: 10px;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #92fe9d;
        }
        
        input[type="text"], input[type="file"] {
            width: 100%;
            padding: 12px 15px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(0, 0, 0, 0.3);
            color: #fff;
            font-size: 16px;
        }
        
        input[type="file"] {
            padding: 10px;
            cursor: pointer;
        }
        
        button {
            background: linear-gradient(90deg, #00c9ff, #92fe9d);
            color: #0f2027;
            border: none;
            padding: 15px 25px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            width: 100%;
            margin-top: 10px;
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 201, 255, 0.4);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        .output-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        @media (max-width: 768px) {
            .output-section {
                grid-template-columns: 1fr;
            }
        }
        
        .output-box {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 20px;
            min-height: 250px;
            max-height: 350px;
            overflow-y: auto;
            margin-top: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .output-box pre {
            white-space: pre-wrap;
            font-family: 'Consolas', monospace;
            font-size: 14px;
            line-height: 1.5;
            color: #fff;
        }
        
        .audio-player {
            width: 100%;
            margin-top: 15px;
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.3);
        }
        
        .section-title {
            font-size: 1.2rem;
            margin: 15px 0 10px;
            color: #92fe9d;
        }
        
        .loader {
            display: none;
            text-align: center;
            margin: 20px 0;
        }
        
        .loader .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 4px solid #00c9ff;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .success-message {
            color: #92fe9d;
            text-align: center;
            margin-top: 10px;
            display: none;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .metric-box {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            transition: transform 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .metric-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 201, 255, 0.2);
        }
        
        .metric-value {
            font-size: 2rem;
            font-weight: bold;
            color: #00c9ff;
            margin: 10px 0;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }
        
        .metric-label {
            font-size: 0.9rem;
            color: #ccc;
        }
        
        .instructions {
            background: rgba(0, 0, 0, 0.3);
            border-left: 4px solid #00c9ff;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }
        
        .instructions h3 {
            color: #92fe9d;
            margin-bottom: 10px;
        }
        
        .instructions ol {
            padding-left: 20px;
        }
        
        .instructions li {
            margin-bottom: 8px;
        }
        
        .file-info {
            background: rgba(0, 0, 0, 0.3);
            padding: 10px 15px;
            border-radius: 8px;
            margin-top: 10px;
            display: none;
        }
        
        .tab-container {
            display: flex;
            margin-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }
        
        .tab.active {
            border-bottom: 3px solid #00c9ff;
            color: #00c9ff;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .word-detail {
            background: rgba(0, 0, 0, 0.2);
            padding: 10px;
            border-radius: 5px;
            margin: 5px 0;
            border-left: 3px solid #00c9ff;
        }
        
        .sentiment-badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
            margin-right: 5px;
        }
        
        .positive {
            background-color: #2ecc71;
            color: #000;
        }
        
        .negative {
            background-color: #e74c3c;
            color: #fff;
        }
        
        .neutral {
            background-color: #3498db;
            color: #fff;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-microphone-alt"></i> Deepgram Audio Analysis</h1>
            <p class="subtitle">Upload audio files to get transcription, sentiment analysis, and vocal metrics</p>
        </header>
        
        <div class="card">
            <h2 class="card-title"><i class="fas fa-cog"></i> Input Parameters</h2>
            <div class="input-group">
                <label for="api-key">Deepgram API Key</label>
                <input type="text" id="api-key" placeholder="Enter your Deepgram API key">
                <small>For demonstration, we're using a mock implementation</small>
            </div>
            
            <div class="input-group">
                <label for="audio-file">Audio File</label>
                <input type="file" id="audio-file" accept="audio/*">
                <div class="file-info" id="file-info">
                    <strong>Selected file:</strong> <span id="file-name"></span>
                    <br>
                    <strong>File size:</strong> <span id="file-size"></span>
                    <br>
                    <strong>File type:</strong> <span id="file-type"></span>
                </div>
            </div>
            
            <button id="process-btn">
                <i class="fas fa-play-circle"></i> Process Audio
            </button>
            
            <div class="loader" id="loader">
                <div class="spinner"></div>
                <p>Processing audio file. This may take a few moments...</p>
            </div>
            
            <div class="success-message" id="success-message">
                <i class="fas fa-check-circle"></i> Audio processed successfully!
            </div>
        </div>
        
        <div class="instructions">
            <h3><i class="fas fa-info-circle"></i> How to use this tool</h3>
            <ol>
                <li>Enter your Deepgram API key (for demonstration, we're using mock data)</li>
                <li>Select an audio file (MP3, WAV, etc.) from your device</li>
                <li>Click the "Process Audio" button to analyze the file</li>
                <li>View the results in the sections below</li>
            </ol>
        </div>
        
        <div class="output-section">
            <div class="card">
                <h2 class="card-title"><i class="fas fa-file-alt"></i> Transcription</h2>
                <div class="output-box" id="transcription-output">
                    <p>Transcription will appear here. The text will be formatted with punctuation and speaker identification when available.</p>
                </div>
            </div>
            
            <div class="card">
                <h2 class="card-title"><i class="fas fa-smile"></i> Sentiment Analysis</h2>
                <div class="output-box" id="sentiment-output">
                    <p>Sentiment analysis will appear here. You'll see overall sentiment and segment-by-segment analysis.</p>
                </div>
            </div>
        </div>
        
        <div class="card">
            <h2 class="card-title"><i class="fas fa-wave-square"></i> Vocal Metrics</h2>
            <div class="metrics-grid" id="vocal-metrics">
                <div class="metric-box">
                    <i class="fas fa-chart-line fa-2x"></i>
                    <div class="metric-label">Pitch (Hz)</div>
                    <div class="metric-value" id="pitch-value">--</div>
                    <div class="metric-label">Fundamental frequency</div>
                </div>
                
                <div class="metric-box">
                    <i class="fas fa-volume-up fa-2x"></i>
                    <div class="metric-label">Intensity</div>
                    <div class="metric-value" id="intensity-value">--</div>
                    <div class="metric-label">Loudness/Energy</div>
                </div>
                
                <div class="metric-box">
                    <i class="fas fa-clock fa-2x"></i>
                    <div class="metric-label">Duration (s)</div>
                    <div class="metric-value" id="duration-value">--</div>
                    <div class="metric-label">Sound length</div>
                </div>
                
                <div class="metric-box">
                    <i class="fas fa-star fa-2x"></i>
                    <div class="metric-label">Voice Quality</div>
                    <div class="metric-value" id="quality-value">--</div>
                    <div class="metric-label">Jitter/Shimmer</div>
                </div>
            </div>
        </div>
        
        <div class="card">
            <h2 class="card-title"><i class="fas fa-code"></i> Raw API Response</h2>
            
            <div class="tab-container">
                <div class="tab active" data-tab="raw">Raw JSON</div>
                <div class="tab" data-tab="words">Word Details</div>
                <div class="tab" data-tab="sentiments">Sentiment Details</div>
            </div>
            
            <div class="tab-content active" id="raw-tab">
                <div class="output-box" id="raw-output">
                    <p>Raw API response will appear here in JSON format.</p>
                </div>
            </div>
            
            <div class="tab-content" id="words-tab">
                <div class="output-box" id="words-output">
                    <p>Detailed word analysis will appear here.</p>
                </div>
            </div>
            
            <div class="tab-content" id="sentiments-tab">
                <div class="output-box" id="sentiments-output">
                    <p>Detailed sentiment analysis will appear here.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const processBtn = document.getElementById('process-btn');
            const apiKeyInput = document.getElementById('api-key');
            const audioFileInput = document.getElementById('audio-file');
            const loader = document.getElementById('loader');
            const successMessage = document.getElementById('success-message');
            const fileInfo = document.getElementById('file-info');
            const fileName = document.getElementById('file-name');
            const fileSize = document.getElementById('file-size');
            const fileType = document.getElementById('file-type');
            
            // Output elements
            const transcriptionOutput = document.getElementById('transcription-output');
            const sentimentOutput = document.getElementById('sentiment-output');
            const rawOutput = document.getElementById('raw-output');
            const wordsOutput = document.getElementById('words-output');
            const sentimentsOutput = document.getElementById('sentiments-output');
            const pitchValue = document.getElementById('pitch-value');
            const intensityValue = document.getElementById('intensity-value');
            const durationValue = document.getElementById('duration-value');
            const qualityValue = document.getElementById('quality-value');
            
            // Tab functionality
            const tabs = document.querySelectorAll('.tab');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabId = tab.getAttribute('data-tab');
                    
                    // Remove active class from all tabs and contents
                    tabs.forEach(t => t.classList.remove('active'));
                    tabContents.forEach(c => c.classList.remove('active'));
                    
                    // Add active class to current tab and content
                    tab.classList.add('active');
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                });
            });
            
            // File input change event
            audioFileInput.addEventListener('change', function() {
                if (this.files.length > 0) {
                    const file = this.files[0];
                    fileName.textContent = file.name;
                    fileSize.textContent = `${(file.size / 1024).toFixed(2)} KB`;
                    fileType.textContent = file.type || 'Unknown';
                    fileInfo.style.display = 'block';
                } else {
                    fileInfo.style.display = 'none';
                }
            });
            
            processBtn.addEventListener('click', function() {
                const apiKey = apiKeyInput.value.trim();
                const file = audioFileInput.files[0];
                
                if (!file) {
                    alert('Please select an audio file');
                    return;
                }
                
                // Show loader, hide success message
                loader.style.display = 'block';
                successMessage.style.display = 'none';
                
                // Clear previous results
                clearResults();
                
                // Simulate API call (in a real implementation, you would use the actual Deepgram API)
                simulateDeepgramAPI(file);
            });
            
            function simulateDeepgramAPI(file) {
                // This is a simulation of the Deepgram API response
                // In a real implementation, you would make a fetch request to the Deepgram API
                
                // Simulate processing time (2-5 seconds)
                const processingTime = 2000 + Math.random() * 3000;
                
                setTimeout(() => {
                    // Sample data for demonstration
                    const sampleTranscription = "Hello, this is a demonstration of the Deepgram audio analysis tool. I'm speaking clearly to show how the API can transcribe speech accurately. The weather is really nice today, and I'm excited to show you this functionality! Unfortunately, we can't connect to the real API directly from the browser due to security restrictions, but this mockup shows what the results would look like.";
                    
                    const sampleSentiment = {
                        sentiment: "positive",
                        confidence: 0.87,
                        segments: [
                            {text: "Hello, this is a demonstration of the Deepgram audio analysis tool.", sentiment: "neutral", confidence: 0.72},
                            {text: "I'm speaking clearly to show how the API can transcribe speech accurately.", sentiment: "positive", confidence: 0.85},
                            {text: "The weather is really nice today, and I'm excited to show you this functionality!", sentiment: "positive", confidence: 0.91},
                            {text: "Unfortunately, we can't connect to the real API directly from the browser due to security restrictions, but this mockup shows what the results would look like.", sentiment: "negative", confidence: 0.65}
                        ]
                    };
                    
                    const sampleVocalMetrics = {
                        pitch: 205.4,
                        intensity: 0.82,
                        duration: 2.45,
                        quality: "0.03 jitter, 0.05 shimmer"
                    };
                    
                    const sampleWords = [
                        {word: "Hello", start: 0.1, end: 0.3, confidence: 0.98, sentiment: "neutral"},
                        {word: "this", start: 0.3, end: 0.4, confidence: 0.99, sentiment: "neutral"},
                        {word: "is", start: 0.4, end: 0.5, confidence: 0.99, sentiment: "neutral"},
                        {word: "a", start: 0.5, end: 0.6, confidence: 0.98, sentiment: "neutral"},
                        {word: "demonstration", start: 0.6, end: 1.1, confidence: 0.95, sentiment: "neutral"},
                        {word: "of", start: 1.1, end: 1.2, confidence: 0.98, sentiment: "neutral"},
                        {word: "the", start: 1.2, end: 1.3, confidence: 0.99, sentiment: "neutral"},
                        {word: "Deepgram", start: 1.3, end: 1.7, confidence: 0.92, sentiment: "neutral"},
                        {word: "audio", start: 1.7, end: 2.0, confidence: 0.96, sentiment: "neutral"},
                        {word: "analysis", start: 2.0, end: 2.4, confidence: 0.94, sentiment: "neutral"},
                        {word: "tool", start: 2.4, end: 2.7, confidence: 0.97, sentiment: "neutral"}
                    ];
                    
                    const sampleRawResponse = {
                        metadata: {
                            transaction_key: "dg_simulated_transaction_123456",
                            request_id: "dg_simulated_request_789012",
                            sha256: "a1b2c3d4e5f67890simulatedhash1234567890abcdef",
                            created: "2023-07-25T10:30:45.000Z",
                            duration: 12.42,
                            channels: 1
                        },
                        results: {
                            channels: [{
                                alternatives: [{
                                    transcript: sampleTranscription,
                                    confidence: 0.92,
                                    words: sampleWords
                                }]
                            }],
                            sentiments: [sampleSentiment],
                            vocals: sampleVocalMetrics
                        }
                    };
                    
                    // Update the UI with the sample data
                    updateUI(
                        sampleTranscription, 
                        sampleSentiment, 
                        sampleVocalMetrics, 
                        sampleRawResponse,
                        sampleWords
                    );
                    
                    // Hide loader, show success message
                    loader.style.display = 'none';
                    successMessage.style.display = 'block';
                }, processingTime);
            }
            
            function updateUI(transcription, sentiment, vocals, rawData, words) {
                // Update transcription
                transcriptionOutput.innerHTML = `<p>${transcription}</p>`;
                
                // Update sentiment
                let sentimentHTML = `
                    <p><strong>Overall Sentiment:</strong> <span class="sentiment-badge ${sentiment.sentiment}">${sentiment.sentiment}</span> (${(sentiment.confidence * 100).toFixed(1)}% confidence)</p>
                    <div class="section-title">Segment Analysis</div>
                `;
                
                if (sentiment.segments && sentiment.segments.length > 0) {
                    sentiment.segments.forEach(segment => {
                        sentimentHTML += `
                            <div class="word-detail">
                                <span class="sentiment-badge ${segment.sentiment}">${segment.sentiment}</span> 
                                (${(segment.confidence * 100).toFixed(1)}%): "${segment.text}"
                            </div>
                        `;
                    });
                }
                
                sentimentOutput.innerHTML = sentimentHTML;
                
                // Update vocal metrics
                pitchValue.textContent = vocals.pitch;
                intensityValue.textContent = vocals.intensity;
                durationValue.textContent = vocals.duration;
                qualityValue.textContent = vocals.quality;
                
                // Update words output
                let wordsHTML = `<div class="section-title">Word-by-Word Analysis</div>`;
                if (words && words.length > 0) {
                    words.forEach(word => {
                        wordsHTML += `
                            <div class="word-detail">
                                <strong>${word.word}</strong> (${word.start}s - ${word.end}s)
                                <br>Confidence: ${(word.confidence * 100).toFixed(1)}%
                                ${word.sentiment ? `<br>Sentiment: <span class="sentiment-badge ${word.sentiment}">${word.sentiment}</span>` : ''}
                            </div>
                        `;
                    });
                }
                wordsOutput.innerHTML = wordsHTML;
                
                // Update sentiments output
                let sentimentsHTML = `<div class="section-title">Detailed Sentiment Analysis</div>`;
                if (sentiment.segments && sentiment.segments.length > 0) {
                    sentiment.segments.forEach(segment => {
                        sentimentsHTML += `
                            <div class="word-detail">
                                <span class="sentiment-badge ${segment.sentiment}">${segment.sentiment}</span> 
                                <strong>Confidence:</strong> ${(segment.confidence * 100).toFixed(1)}%
                                <br><strong>Text:</strong> "${segment.text}"
                            </div>
                        `;
                    });
                }
                sentimentsOutput.innerHTML = sentimentsHTML;
                
                // Show raw response
                rawOutput.innerHTML = `<pre>${JSON.stringify(rawData, null, 2)}</pre>`;
            }
            
            function clearResults() {
                transcriptionOutput.innerHTML = '<p>Transcription will appear here...</p>';
                sentimentOutput.innerHTML = '<p>Sentiment analysis will appear here...</p>';
                pitchValue.textContent = '--';
                intensityValue.textContent = '--';
                durationValue.textContent = '--';
                qualityValue.textContent = '--';
                rawOutput.innerHTML = '<p>Raw API response will appear here...</p>';
                wordsOutput.innerHTML = '<p>Detailed word analysis will appear here.</p>';
                sentimentsOutput.innerHTML = '<p>Detailed sentiment analysis will appear here.</p>';
            }
        });
    </script>
</body>
</html>
